{"ast":null,"code":"var _jsxFileName = \"F:\\\\JAVA_WORKSPACE\\\\frontend_react-20191018T023535Z-001\\\\frontend_react\\\\src\\\\components\\\\chat\\\\chat.js\";\nimport React, { Component } from 'react';\nimport { Input } from 'antd';\nimport './chat.css';\nimport SockJsClient from \"react-stomp\";\nimport UsernameGenerator from \"username-generator\";\nimport Fetch from \"json-fetch\";\nimport { TalkBox } from \"react-talk\";\nimport randomstring from \"randomstring\";\n\nclass chat extends Component {\n  constructor(props, context) {\n    super(props);\n    this.state = {\n      messages: \"\",\n      clientConnected: false,\n      messages2: [{\n        \"author\": \"Ponger\",\n        \"authorId\": \"pong\",\n        \"message\": \"How you doin'!\",\n        \"timestamp\": new Date(Date.UTC(1996, 1, 2, 3, 4, 5)).toString()\n      }, {\n        \"author\": \"Ponger2\",\n        \"authorId\": \"pong\",\n        \"message\": \"zzz!\",\n        \"timestamp\": new Date(Date.UTC(2020, 3, 10, 23, 5, 5)).toString()\n      }]\n    };\n\n    this.sendMessage = e => {\n      //  console.log(e.key)\n      if (e.key === 'Enter') {\n        const s = {\n          name: \"USER\",\n          session: \"0\",\n          content: this.state.messages\n        };\n        this.clientRef.sendMessage(\"/app/hello\", JSON.stringify(s));\n      }\n    };\n\n    this.onMessageReceive = msg => {\n      this.setState(prevState => ({\n        messages: [...prevState.messages, msg]\n      }));\n    };\n\n    this.updateInputValue = evt => {\n      //console.log(evt);\n      //console.log(evt.target.value)\n      this.setState({\n        text: evt.target.value\n      });\n    };\n\n    this.sendMessage2 = (msg, selfMsg) => {\n      // selfMsg is the message object constructed from the message typed by the current user\n      // NOTE: selfMsg doesn't include timestamp and needs to be added by the user of the module\n      // in client or server side as required\n      selfMsg[\"timestamp\"] = Date.now().toString();\n      this.setState(prevState => ({\n        messages2: [...prevState.messages, selfMsg]\n      })); // If message sending failed return false otherwise return true\n\n      try {\n        // Insert code to send the message below\n        const s = {\n          name: \"USER\",\n          session: \"0\",\n          content: msg\n        };\n        this.clientRef.sendMessage(\"/app/hello\", JSON.stringify(s));\n        return true;\n      } catch (e) {\n        return false;\n      }\n    };\n  }\n\n  render() {\n    const wsSourceUrl = \"http://localhost:8076/chat\";\n    const Search = Input.Search;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(TalkBox, {\n      topic: \"/topic/testchat\",\n      currentUserId: \"123\",\n      currentUser: \"123\",\n      messages: this.state.messages2,\n      onSendMessage: this.sendMessage2,\n      connected: this.state.clientConnected,\n      onKeyDown: this.updateInputValue,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(SockJsClient, {\n      url: \"http://localhost:8076/chat\",\n      topics: [\"/topics/testchat\"],\n      onMessage: msg => {\n        console.log(msg);\n      },\n      ref: client => {\n        this.clientRef = client;\n      },\n      onConnect: () => {\n        this.setState({\n          clientConnected: true\n        });\n      },\n      onDisconnect: () => {\n        this.setState({\n          clientConnected: false\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      onKeyDown: this.sendMessage,\n      onChange: this.updateInputValue,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 13\n      }\n    })) //     <div>\n    //     <TalkBox topic=\"/topic/public\" currentUserId={ this.randomUserId }\n    //       currentUser={ this.randomUserName } messages={ this.state.messages }\n    //       onSendMessage={ this.sendMessage } connected={ this.state.clientConnected }/>\n    //     <SockJsClient url={ wsSourceUrl } topics={[\"/topic/public\"]}\n    //       onMessage={ this.onMessageReceive } ref={ (client) => { this.clientRef = client }}\n    //       onConnect={ () => {this.setState({ clientConnected: true }) } }\n    //       onDisconnect={ () => { this.setState({ clientConnected: false }) } }\n    //       debug={ false } style={[{width:'100%', height:'100%'}]}/>\n    //   </div>\n    // <div>\n    //     <div id=\"container\">\n    //         <div id=\"chatView\">\n    //             <div class=\"msg\" id=\"chat-me\">\n    //                 정영석\n    //             <li class=\"msgBox\">채팅1</li>\n    //             </div>\n    //             <div class=\"msg\" id=\"chat-other\">\n    //                 남영덕\n    //             <li class=\"msgBox\">채팅2</li>\n    //             </div>\n    //             <div class=\"msg\" id=\"chat-other\">\n    //                 최기석\n    //             <li class=\"msgBox\">채팅3</li>\n    //             </div>\n    //         </div>\n    //         <Search\n    //                 placeholder=\"보낼 메시지를 입력하세요\"\n    //                 enterButton=\"보내기\"\n    //                 size=\"large\"\n    //                 onSearch={value => console.log(value)}\n    //         />\n    //     </div>  \n    // </div>\n    ;\n  }\n\n}\n\nexport default chat;","map":{"version":3,"sources":["F:/JAVA_WORKSPACE/frontend_react-20191018T023535Z-001/frontend_react/src/components/chat/chat.js"],"names":["React","Component","Input","SockJsClient","UsernameGenerator","Fetch","TalkBox","randomstring","chat","constructor","props","context","state","messages","clientConnected","messages2","Date","UTC","toString","sendMessage","e","key","s","name","session","content","clientRef","JSON","stringify","onMessageReceive","msg","setState","prevState","updateInputValue","evt","text","target","value","sendMessage2","selfMsg","now","render","wsSourceUrl","Search","console","log","client"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport {Input} from 'antd';\r\nimport './chat.css';\r\nimport SockJsClient  from \"react-stomp\";\r\nimport UsernameGenerator from \"username-generator\";\r\nimport Fetch from \"json-fetch\";\r\nimport { TalkBox } from \"react-talk\";\r\nimport randomstring from\"randomstring\";\r\n\r\n\r\nclass chat extends Component {\r\n\r\n    constructor(props, context) {\r\n        super(props);\r\n    }\r\n\r\n    state = {\r\n        messages : \"\",\r\n        clientConnected:false,\r\n        messages2: [{\r\n            \"author\": \"Ponger\",\r\n            \"authorId\": \"pong\",\r\n            \"message\": \"How you doin'!\",\r\n            \"timestamp\": new Date(Date.UTC(1996, 1, 2, 3, 4, 5)).toString()\r\n        },\r\n        {\r\n            \"author\": \"Ponger2\",\r\n            \"authorId\": \"pong\",\r\n            \"message\": \"zzz!\",\r\n            \"timestamp\":   new Date(Date.UTC(2020, 3, 10,23,5,5)).toString()\r\n        }\r\n    \r\n    ]\r\n        \r\n    }\r\n\r\n\r\n\r\n\r\n    //   componentWillMount() {\r\n    //     console.log(\"call history\");\r\n    //     Fetch(\"/history\", {\r\n    //       method: \"GET\"\r\n    //     }).then((response) => {\r\n    //       this.setState({ messages: response.body });\r\n    //     });\r\n    //   }\r\n    \r\n    sendMessage = (e) => {\r\n      //  console.log(e.key)\r\n        if (e.key ==='Enter') {\r\n\r\n            const s = {name: \"USER\", session: \"0\", content: this.state.messages}\r\n            this.clientRef.sendMessage(\"/app/hello\", JSON.stringify(s));\r\n       }\r\n\r\n        }\r\n\r\n        onMessageReceive = (msg) => {\r\n            this.setState(prevState => ({\r\n                messages: [...prevState.messages, msg]\r\n            }));\r\n          }\r\n    \r\n        updateInputValue = (evt) =>{\r\n            //console.log(evt);\r\n            //console.log(evt.target.value)\r\n            this.setState({\r\n                text: evt.target.value\r\n            });\r\n            \r\n          }\r\n\r\n          sendMessage2 = (msg, selfMsg) => {\r\n            // selfMsg is the message object constructed from the message typed by the current user\r\n            // NOTE: selfMsg doesn't include timestamp and needs to be added by the user of the module\r\n            // in client or server side as required\r\n            selfMsg[\"timestamp\"] = Date.now().toString();\r\n            this.setState(prevState => ({\r\n                messages2: [...prevState.messages, selfMsg]\r\n            }));\r\n            // If message sending failed return false otherwise return true\r\n            try {\r\n              // Insert code to send the message below\r\n\r\n              const s = {name: \"USER\", session: \"0\", content: msg}\r\n              this.clientRef.sendMessage(\"/app/hello\", JSON.stringify(s));\r\n              \r\n              return true;\r\n            } catch (e) {\r\n              return false;\r\n            }\r\n          }\r\n      \r\n\r\n    render() {\r\n\r\n        const wsSourceUrl = \"http://localhost:8076/chat\";\r\n         const { Search } = Input;\r\n        return (\r\n            <div>\r\n            <TalkBox topic=\"/topic/testchat\" currentUserId=\"123\"\r\n                currentUser=\"123\" messages={this.state.messages2}\r\n               onSendMessage={ this.sendMessage2 } connected={this.state.clientConnected}\r\n               onKeyDown={this.updateInputValue}\r\n               />\r\n\r\n            <SockJsClient\r\n            url=\"http://localhost:8076/chat\"\r\n            topics={[\"/topics/testchat\"]}\r\n            onMessage={(msg) => { console.log(msg); }}\r\n            ref={(client) => { this.clientRef = client; }} \r\n            onConnect={ () => {this.setState({ clientConnected: true }) } }\r\n            onDisconnect={ () => { this.setState({ clientConnected: false }) } }\r\n            />\r\n\r\n            <input type=\"text\" onKeyDown={this.sendMessage} onChange={this.updateInputValue}></input>\r\n            </div>\r\n\r\n        //     <div>\r\n        //     <TalkBox topic=\"/topic/public\" currentUserId={ this.randomUserId }\r\n        //       currentUser={ this.randomUserName } messages={ this.state.messages }\r\n        //       onSendMessage={ this.sendMessage } connected={ this.state.clientConnected }/>\r\n            \r\n        //     <SockJsClient url={ wsSourceUrl } topics={[\"/topic/public\"]}\r\n        //       onMessage={ this.onMessageReceive } ref={ (client) => { this.clientRef = client }}\r\n        //       onConnect={ () => {this.setState({ clientConnected: true }) } }\r\n        //       onDisconnect={ () => { this.setState({ clientConnected: false }) } }\r\n        //       debug={ false } style={[{width:'100%', height:'100%'}]}/>\r\n        //   </div>\r\n            // <div>\r\n            //     <div id=\"container\">\r\n            //         <div id=\"chatView\">\r\n            //             <div class=\"msg\" id=\"chat-me\">\r\n            //                 정영석\r\n            //             <li class=\"msgBox\">채팅1</li>\r\n            //             </div>\r\n            //             <div class=\"msg\" id=\"chat-other\">\r\n            //                 남영덕\r\n            //             <li class=\"msgBox\">채팅2</li>\r\n            //             </div>\r\n            //             <div class=\"msg\" id=\"chat-other\">\r\n            //                 최기석\r\n            //             <li class=\"msgBox\">채팅3</li>\r\n            //             </div>\r\n            //         </div>\r\n            //         <Search\r\n            //                 placeholder=\"보낼 메시지를 입력하세요\"\r\n            //                 enterButton=\"보내기\"\r\n            //                 size=\"large\"\r\n            //                 onSearch={value => console.log(value)}\r\n            //         />\r\n            //     </div>  \r\n            // </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default chat;"]},"metadata":{},"sourceType":"module"}